---
layout: post
title: "Morning Madness"
tags: ["W", "W", "algorithms", "algorithms", "bush", "bush", "c", "c", "code", "code", "complaints", "complaints", "democrats", "democrats", "endless war", "endless war", "evil politicians", "evil politicians", "hillary clinton", "hillary clinton", "patents", "patents"]
---
Original post can be found at:  <a href="http://ealdent.wordpress.com/2007/11/02/morning-madness/" target="_blank">http://ealdent.wordpress.com/2007/11/02/morning-madness/</a><br /><br />
<p align="justify">Ever get pissed twice before you've really even opened your eyes?  This is why I shouldn't read my RSS feeds so early in the morning.  At the top of the list is Bush equating Democrats who oppose the war (as if it could be called opposition, anyway) to those who ignored Hitler and Lenin and then Hillary firing back.  Am I mad at Bush for making this analogy?  No and I think he's correct, but not in the way he thinks.  I'm more angry at Hillary for firing back and not recognizing her own culpability. The Sheepocrats sat back and did nothing four years ago when this war began and passed the Patriot Act before that.  They have endorsed the war at every stage since and even their current so-called opposition is luke-warm and putrid with its weasliness.  So yeah, they are like people who ignored the rise of Hitler and Lenin.  If she had recognized that and said it publicly, it would have done her credit.</p>
<p align="justify">&nbsp;</p>
<p align="justify">Next up, I was reading a few <a href="http://graphics.stanford.edu/~seander/bithacks.html" target="_blank">bit twiddling hacks</a> and came across a nice one for branchless absolute value [<a href="http://dpn.name/index.php/2007/11/02/links-for-2007-11-02/" target="_blank">hat tip</a>].  The hacks are all in the public domain, too, so that's good.  He does list the occasional variation that is patented, an enormously helpful fact if you're producing commercial software.  So here is the <strong>patented version</strong> of the branchless absolute value:</p>
<code>
int v;      // we want to find the absolute value of v
int r;      // the result goes here
int const mask = v &gt;&gt; sizeof(int) * CHAR_BIT - 1;
r = (v ^ mask) - mask;
</code>

The last ^ (XOR) - (subtract) combination represents the patent.  What works also?

<code>r = (v + mask) ^ mask;</code>
<p align="justify">As Sean points out, though, the <a href="http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=/netahtml/search-adv.htm&r=1&f=G&l=50&d=ptxt&S1=6073150&OS=6073150&RS=6073150" target="_blank">patent</a> probably could be contested if the holder (none other than Sun Microsystems) ever tried to enforce it.  So what ticked me off is that such a thing could be patented.  I raise my hands in impotent fury at the ludicrousness of software patents.  I don't blame the inventors for them, it's something you pretty much have to do these days.  I blame the system that makes that true.</p>

<h3>Update</h3>
<p>Did some benchmarks on the two versions of absolute value given above.  Using a 3.06GHz processor, I could run 4 billion absolute values in 18.916 +/- 0.021 seconds for the patented version and 18.906 +/- 0.026 seconds for the free version.  So no need to even bother with the patented version it looks like.</p>
